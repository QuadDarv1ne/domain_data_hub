# Создание базы данных для агентства недвижимости

### Структура БД

```
+--------------------+         +----------------------+
|      Users         |         |      Roles           |
+--------------------+         +----------------------+
| user_id (PK)       |◄───────┐| role_id (PK)         |
| username           |         | role_name            |
| email              |         +----------------------+
| password           |
| first_name         |
| last_name          |
| phone              |
| address            |
| role_id (FK)       |
+--------------------+
           ▲
           │
           │
+----------------------+
|    Properties        |
+----------------------+
| property_id (PK)     |
| title                |
| description          |
| price                |
| property_type        |
| area                 |
| address              |
| status               |
| agent_id (FK)        |
+----------------------+
           ▲
           │
           │
+----------------------+
|    Transactions      |
+----------------------+
| transaction_id (PK)  |
| property_id (FK)     |
| buyer_id (FK)        |
| sale_price           |
| transaction_date     |
+----------------------+
           ▲
           │
           │
+----------------------+
|      Rentals         |
+----------------------+
| rental_id (PK)       |
| property_id (FK)     |
| renter_id (FK)       |
| rent_price           |
| start_date           |
| end_date             |
| rental_status        |
+----------------------+
           ▲
           │
           │
+----------------------+
|    PriceHistory      |
+----------------------+
| history_id (PK)      |
| property_id (FK)     |
| price                |
| change_date          |
+----------------------+
           ▲
           │
           │
+----------------------+
|   PropertyViews      |
+----------------------+
| view_id (PK)         |
| property_id (FK)     |
| user_id (FK)         |
| view_date            |
+----------------------+
```

### Объяснение cвязей

1. `Users (Пользователи)`: Хранят данные о пользователях, включая их роль (через внешний ключ role_id).
2. `Properties (Недвижимость)`: Хранят данные о недвижимости, включая связь с агентами через agent_id.
3. `Transactions (Сделки)`: Содержит информацию о сделках, связанных с объектами недвижимости и покупателями.
4. `Rentals (Аренда)`: Хранят данные о договорах аренды объектов.
5. `PriceHistory (История цен)`: Сохраняет информацию об изменениях цен объектов недвижимости.
6. `PropertyViews (Просмотры объектов)`: Записывает просмотры объектов пользователями.
7. `Roles (Роли)`: Хранит роли пользователей (например, администратор, клиент и т.д.).

#### Взаимосвязи:

`Users ↔ Roles`: Один пользователь может иметь одну роль (например, клиент или агент).
`Users ↔ Properties`: Агент недвижимости (пользователь) может быть связан с несколькими объектами недвижимости.
`Properties ↔ Transactions`, `Rentals`, `PriceHistory`, `PropertyViews`: Один объект недвижимости может иметь множество сделок, аренды, изменений цен и просмотров.


**Автор:** Дуплей Максим Игоревич

**Дата:** 17.11.2024
